#!/usr/bin/env python3
import os
import logging
import json
import random
from typing import List, Dict, Tuple, Optional
from datetime import datetime
from enum import Enum
from dataclasses import dataclass, asdict
from dotenv import load_dotenv
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, CallbackQueryHandler, filters, ContextTypes

logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

load_dotenv()


@dataclass
class TulInfo:
    """–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É–ª—è—Ö"""
    name: str
    korean_name: str
    belt: str
    movements: int
    meaning: str
    history: str
    diagram: str = ""
    keywords: List[str] = None

    def __post_init__(self):
        if self.keywords is None:
            self.keywords = []


class TaekwondoKnowledgeSystem:
    """–°–∏—Å—Ç–µ–º–∞ –∑–Ω–∞–Ω–∏–π –ø–æ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¢—É–ª—è—Ö"""

    def __init__(self, data_dir: str = "taekwondo_data"):
        self.data_dir = data_dir
        os.makedirs(data_dir, exist_ok=True)

        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        self.tuls = self._load_tuls()
        self.belts = self._load_belts_system()
        self.techniques = self._load_techniques()
        self.knowledge_base = self._create_complete_knowledge_base()

        # –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
        self.conversation_history = {}

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
        self._validate_data()

    def _validate_data(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö"""
        issues = []

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—É–ª–µ–π
        for tul in self.tuls:
            if not tul.name or not tul.belt:
                issues.append(f"–¢—É–ª—å –±–µ–∑ –∏–º–µ–Ω–∏ –∏–ª–∏ –ø–æ—è—Å–∞: {tul}")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—è—Å–æ–≤
        for belt_key, belt_info in self.belts.items():
            for tul_name in belt_info.get("tuls", []):
                if not self.get_tul_by_name(tul_name):
                    issues.append(f"–ü–æ—è—Å {belt_key} —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç—É–ª—å: {tul_name}")

        if issues:
            logger.warning(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –≤ –¥–∞–Ω–Ω—ã—Ö: {len(issues)} issues")
            for issue in issues[:5]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 –ø—Ä–æ–±–ª–µ–º
                logger.warning(f"  - {issue}")

        return len(issues) == 0

    def _load_tuls(self) -> List[TulInfo]:
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—É–ª—è—Ö"""
        tuls_data = [
            # 10 –≥—ã–ø
            TulInfo(
                name="–°–∞–¥–∂—É-–ß–∞—Ä–∏–≥–∏",
                korean_name="ÏÇ¨Ï£º ÏßÄÎ•¥Í∏∞",
                belt="10 –≥—ã–ø (–±–µ–ª—ã–π –ø–æ—è—Å)",
                movements=4,
                meaning="–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ - —É–¥–∞—Ä –≤ —á–µ—Ç—ã—Ä–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
                history="–ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä—è–º—ã—Ö —É–¥–∞—Ä–æ–≤ —Ä—É–∫–∞–º–∏ –≤ —á–µ—Ç—ã—Ä–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã. –ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –∏ —á—É–≤—Å—Ç–≤–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.",
                diagram="–ü—Ä—è–º–æ–π –∫—Ä–µ—Å—Ç (+), –¥–≤–∏–∂–µ–Ω–∏—è –≤ —á–µ—Ç—ã—Ä–µ —Å—Ç–æ—Ä–æ–Ω—ã: –≤–ø–µ—Ä–µ–¥, –Ω–∞–∑–∞–¥, –≤–ª–µ–≤–æ, –≤–ø—Ä–∞–≤–æ",
                keywords=["—Å–∞–¥–∂—É", "—á–∞—Ä–∏–≥–∏", "–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω–æ–µ", "4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è", "–±–∞–∑–æ–≤–æ–µ"]
            ),
            TulInfo(
                name="–°–∞–¥–∂—É-–ú–∞–∫–∫–∏",
                korean_name="ÏÇ¨Ï£º ÎßâÍ∏∞",
                belt="10 –≥—ã–ø (–±–µ–ª—ã–π –ø–æ—è—Å)",
                movements=4,
                meaning="–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ - –±–ª–æ–∫ –≤ —á–µ—Ç—ã—Ä–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
                history="–ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—â–∏—Ç–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —á–µ—Ç—ã—Ä–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã.",
                diagram="–ü—Ä—è–º–æ–π –∫—Ä–µ—Å—Ç (+), –±–ª–æ–∫–∏ –≤ —á–µ—Ç—ã—Ä–µ —Å—Ç–æ—Ä–æ–Ω—ã",
                keywords=["—Å–∞–¥–∂—É", "–º–∞–∫–∫–∏", "–±–ª–æ–∫", "–∑–∞—â–∏—Ç–∞", "4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è"]
            ),

            # 9 –≥—ã–ø
            TulInfo(
                name="–ß–æ–Ω-–î–∂–∏",
                korean_name="Ï≤úÏßÄ",
                belt="9 –≥—ã–ø (–±–µ–ª—ã–π —Å –∂–µ–ª—Ç–æ–π –ø–æ–ª–æ—Å–∫–æ–π)",
                movements=19,
                meaning="–ù–µ–±–æ –∏ –ó–µ–º–ª—è",
                history="–ü–µ—Ä–≤—ã–π —Ç—É–ª—å. –°–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏—Ö–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏—Ä–æ–¥—ã. –°–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —Å—Ö–æ–∂–∏—Ö —á–∞—Å—Ç–µ–π: –æ–¥–Ω–∞ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–µ–±–æ, –¥—Ä—É–≥–∞—è - –∑–µ–º–ª—é.",
                diagram="–§–æ—Ä–º–∞ –±—É–∫–≤—ã 'I' („Ö£), –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ",
                keywords=["—á–æ–Ω-–¥–∂–∏", "–ø–µ—Ä–≤—ã–π —Ç—É–ª—å", "–Ω–µ–±–æ –∑–µ–º–ª—è", "19 –¥–≤–∏–∂–µ–Ω–∏–π", "–æ—Å–Ω–æ–≤–∞"]
            ),

            # 8 –≥—ã–ø
            TulInfo(
                name="–î–∞–Ω-–ì—É–Ω",
                korean_name="Îã®Íµ∞",
                belt="8 –≥—ã–ø (–∂–µ–ª—Ç—ã–π –ø–æ—è—Å)",
                movements=21,
                meaning="–û—Å–Ω–æ–≤–∞—Ç–µ–ª—å –ö–æ—Ä–µ–∏",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—è –ö–æ—Ä–µ–∏ –î–∞–Ω-–ì—É–Ω–∞, –∂–∏–≤—à–µ–≥–æ –≤ 2333 –≥–æ–¥—É –¥–æ –Ω–∞—à–µ–π —ç—Ä—ã. –°—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Ç–æ–º–∫–æ–º –Ω–µ–±–µ—Å–Ω–æ–≥–æ –≤–ª–∞–¥—ã–∫–∏ –∏ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–º –ø–µ—Ä–≤–æ–≥–æ –∫–æ—Ä–µ–π—Å–∫–æ–≥–æ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–∞ –ö–æ—á–æ—Å–æ–Ω.",
                diagram="–§–æ—Ä–º–∞ –±—É–∫–≤—ã 'I' („Ö£)",
                keywords=["–¥–∞–Ω-–≥—É–Ω", "–æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å –∫–æ—Ä–µ–∏", "2333 –¥–æ –Ω.—ç.", "21 –¥–≤–∏–∂–µ–Ω–∏–µ", "–∂–µ–ª—Ç—ã–π –ø–æ—è—Å"]
            ),

            # 7 –≥—ã–ø
            TulInfo(
                name="–î–æ-–°–∞–Ω",
                korean_name="ÎèÑÏÇ∞",
                belt="7 –≥—ã–ø (–∂–µ–ª—Ç—ã–π —Å –∑–µ–ª–µ–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π)",
                movements=24,
                meaning="–ü—Å–µ–≤–¥–æ–Ω–∏–º –ø–∞—Ç—Ä–∏–æ—Ç–∞",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –ø–∞—Ç—Ä–∏–æ—Ç–∞ –ê–Ω –ß—Ö–∞–Ω –•–æ (1876-1938), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–µ–≥–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º '–î–æ-–°–∞–Ω'. –û–Ω –ø–æ—Å–≤—è—Ç–∏–ª —Å–≤–æ—é –∂–∏–∑–Ω—å –ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏—é –∫–æ—Ä–µ–π—Å–∫–æ–≥–æ –Ω–∞—Ä–æ–¥–∞ –∏ –±–æ—Ä—å–±–µ –∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ö–æ—Ä–µ–∏ –æ—Ç —è–ø–æ–Ω—Å–∫–æ–π –æ–∫–∫—É–ø–∞—Ü–∏–∏.",
                diagram="–ì–æ—Ä–∞ –∏ —Å–æ–ª–Ω—Ü–µ (—Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ—Å—Ö–æ–¥ –Ω–∞–¥ –≥–æ—Ä–æ–π)",
                keywords=["–¥–æ-—Å–∞–Ω", "–∞–Ω —á—Ö–∞–Ω —Ö–æ", "–ø–∞—Ç—Ä–∏–æ—Ç", "24 –¥–≤–∏–∂–µ–Ω–∏—è", "–ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏–µ"]
            ),

            # 6 –≥—ã–ø
            TulInfo(
                name="–í–æ–Ω-–•—å—ë",
                korean_name="ÏõêÌö®",
                belt="6 –≥—ã–ø (–∑–µ–ª–µ–Ω—ã–π –ø–æ—è—Å)",
                movements=28,
                meaning="–ë—É–¥–¥–∏–π—Å–∫–∏–π –º–æ–Ω–∞—Ö",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –º–æ–Ω–∞—Ö–∞ –í–æ–Ω-–•—å—ë (617-686), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª –±—É–¥–¥–∏–∑–º –¥–∏–Ω–∞—Å—Ç–∏–∏ –°–∏–ª–ª–∞ –≤ 686 –≥–æ–¥—É. –ò–∑–≤–µ—Å—Ç–µ–Ω —Å–∏–Ω—Ç–µ–∑–æ–º –±—É–¥–¥–∏–∑–º–∞ —Å –∫–æ—Ä–µ–π—Å–∫–∏–º–∏ —Ç—Ä–∞–¥–∏—Ü–∏—è–º–∏.",
                diagram="–ë—É–¥–¥–∏–π—Å–∫–∏–π —Å–∏–º–≤–æ–ª (—Å–≤–∞—Å—Ç–∏–∫–∞ –º–∞–Ω)",
                keywords=["–≤–æ–Ω-—Ö—å—ë", "–º–æ–Ω–∞—Ö", "–±—É–¥–¥–∏–∑–º", "28 –¥–≤–∏–∂–µ–Ω–∏–π", "–¥–∏–Ω–∞—Å—Ç–∏—è —Å–∏–ª–ª–∞"]
            ),

            # 5 –≥—ã–ø
            TulInfo(
                name="–Æ–ª—å-–ì–æ–∫",
                korean_name="Ïú®Í≥°",
                belt="5 –≥—ã–ø (–∑–µ–ª–µ–Ω—ã–π —Å —Å–∏–Ω–µ–π –ø–æ–ª–æ—Å–∫–∞)",
                movements=38,
                meaning="–ö–æ—Ä–µ–π—Å–∫–∏–π –ö–æ–Ω—Ñ—É—Ü–∏–π",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å —Ñ–∏–ª–æ—Å–æ—Ñ–∞ –∏ —É—á–µ–Ω–æ–≥–æ –ò –ò (1536-1584), –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–æ–¥ –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º '–Æ–ª—å-–ì–æ–∫'. 38 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 38-—é –ø–∞—Ä–∞–ª–ª–µ–ª—å, –≥–¥–µ –æ–Ω —Ä–æ–¥–∏–ª—Å—è. –ü—Ä–æ–∑–≤–∞–Ω '–ö–æ–Ω—Ñ—É—Ü–∏–µ–º –ö–æ—Ä–µ–∏'.",
                diagram="–ò–µ—Ä–æ–≥–ª–∏—Ñ '—É—á–µ–Ω—ã–π' (Â£´)",
                keywords=["—é–ª—å-–≥–æ–∫", "–∏ –∏", "—Ñ–∏–ª–æ—Å–æ—Ñ", "38 –¥–≤–∏–∂–µ–Ω–∏–π", "–∫–æ–Ω—Ñ—É—Ü–∏–∞–Ω–µ—Ü"]
            ),

            # 4 –≥—ã–ø
            TulInfo(
                name="–î–∂—É–Ω-–ì—É–Ω",
                korean_name="Ï§ëÍ∂Å",
                belt="4 –≥—ã–ø (—Å–∏–Ω–∏–π –ø–æ—è—Å)",
                movements=32,
                meaning="–ü–∞—Ç—Ä–∏–æ—Ç-–º—É—á–µ–Ω–∏–∫",
                history="–ù–∞–∑–≤–∞–Ω –≤ –ø–∞–º—è—Ç—å –æ –ø–∞—Ç—Ä–∏–æ—Ç–µ –ê–Ω –î–∂—É–Ω-–ì—É–Ω–µ (1879-1910), –∫–æ—Ç–æ—Ä—ã–π —É–±–∏–ª —è–ø–æ–Ω—Å–∫–æ–≥–æ –≥–µ–Ω–µ—Ä–∞–ª-–≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä–∞ –ö–æ—Ä–µ–∏ –ò—Ç–æ –•–∏—Ä–æ–±—É–º–∏. 32 –¥–≤–∏–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –≤–æ–∑—Ä–∞—Å—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ–≥–æ –∫–∞–∑–Ω–∏–ª–∏ –≤ —Ç—é—Ä—å–º–µ –õ—é–π—à—É–Ω—å.",
                diagram="–¢—é—Ä–µ–º–Ω–∞—è —Ä–µ—à–µ—Ç–∫–∞ (—Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–∫–ª—é—á–µ–Ω–∏–µ)",
                keywords=["–¥–∂—É–Ω-–≥—É–Ω", "–∞–Ω –¥–∂—É–Ω-–≥—É–Ω", "–ø–∞—Ç—Ä–∏–æ—Ç", "32 –¥–≤–∏–∂–µ–Ω–∏—è", "–∫–∞–∑–Ω—å"]
            ),

            # 3 –≥—ã–ø
            TulInfo(
                name="–¢—ç—ë-–ì—ç",
                korean_name="Ìá¥Í≥Ñ",
                belt="3 –≥—ã–ø (—Å–∏–Ω–∏–π —Å –∫—Ä–∞—Å–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π)",
                movements=37,
                meaning="–£—á–µ–Ω—ã–π-–Ω–µ–æ–∫–æ–Ω—Ñ—É—Ü–∏–∞–Ω–µ—Ü",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å —É—á–µ–Ω–æ–≥–æ –õ–∏ –•–≤–∞–Ω–∞ (1501-1570), –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–æ–¥ –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º '–¢—ç—ë-–ì—ç'. 37 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 37-—é –ø–∞—Ä–∞–ª–ª–µ–ª—å, –º–µ—Å—Ç–æ –µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è. –ò–∑–≤–µ—Å—Ç–Ω—ã–π –º–∞—Å—Ç–µ—Ä –Ω–µ–æ–∫–æ–Ω—Ñ—É—Ü–∏–∞–Ω—Å—Ç–≤–∞.",
                diagram="–ò–µ—Ä–æ–≥–ª–∏—Ñ '–≥–æ—Ä—ã –∏ –≤–æ–¥–∞' (Â±±Ê∞¥)",
                keywords=["—Ç—ç—ë-–≥—ç", "–ª–∏ —Ö–≤–∞–Ω", "—É—á–µ–Ω—ã–π", "37 –¥–≤–∏–∂–µ–Ω–∏–π", "–Ω–µ–æ–∫–æ–Ω—Ñ—É—Ü–∏–∞–Ω—Å—Ç–≤–æ"]
            ),

            # 2 –≥—ã–ø
            TulInfo(
                name="–•–≤–∞-–†–∞–Ω–≥",
                korean_name="ÌôîÎûë",
                belt="2 –≥—ã–ø (–∫—Ä–∞—Å–Ω—ã–π –ø–æ—è—Å)",
                movements=29,
                meaning="–¶–≤–µ—Ç–æ—á–Ω–∞—è –º–æ–ª–æ–¥–µ–∂—å",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –æ–±—â–µ—Å—Ç–≤–∞ –º–æ–ª–æ–¥—ã—Ö –∞—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç–æ–≤ '–•–≤–∞—Ä–∞–Ω' ('–¶–≤–µ—Ç–æ—á–Ω—ã–µ —Ä—ã—Ü–∞—Ä–∏'), –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –≤ 576 –≥–æ–¥—É –ø—Ä–∏ –¥–∏–Ω–∞—Å—Ç–∏–∏ –°–∏–ª–ª–∞. –û–±—â–µ—Å—Ç–≤–æ —Å—Ç–∞–ª–æ –¥–≤–∏–∂—É—â–µ–π —Å–∏–ª–æ–π –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç—Ä–µ—Ö –∫–æ—Ä–µ–π—Å–∫–∏—Ö –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤. 29 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 29-—é –ø–µ—Ö–æ—Ç–Ω—É—é –¥–∏–≤–∏–∑–∏—é, –≥–¥–µ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ.",
                diagram="–¶–≤–µ—Ç–æ–∫ (—Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –º–æ–ª–æ–¥–µ–∂—å)",
                keywords=["—Ö–≤–∞-—Ä–∞–Ω–≥", "—Ü–≤–µ—Ç–æ—á–Ω—ã–µ —Ä—ã—Ü–∞—Ä–∏", "29 –¥–≤–∏–∂–µ–Ω–∏–π", "–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ", "–¥–∏–∞–≥—Ä–∞–º–º–∞ —Ü–≤–µ—Ç–∫–∞"]
            ),

            # 1 –≥—ã–ø
            TulInfo(
                name="–ß—É–Ω–≥-–ú—É",
                korean_name="Ï∂©Î¨¥",
                belt="1 –≥—ã–ø (–∫—Ä–∞—Å–Ω—ã–π —Å —á–µ—Ä–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π)",
                movements=30,
                meaning="–í–µ—Ä–Ω—ã–π –≤–æ–∏–Ω",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –∞–¥–º–∏—Ä–∞–ª–∞ –õ–∏ –°—É–Ω –°–∏–Ω–∞ (1545-1598) –¥–∏–Ω–∞—Å—Ç–∏–∏ –ß–æ—Å–æ–Ω, —Å–æ–∑–¥–∞—Ç–µ–ª—è –ø–µ—Ä–≤—ã—Ö –±—Ä–æ–Ω–µ–Ω–æ—Å–Ω—ã—Ö –∫–æ—Ä–∞–±–ª–µ–π '–∫–æ–±—É–∫—Å–æ–Ω'. –¢—É–ª—å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —É–¥–∞—Ä–æ–º –ª–µ–≤–æ–π —Ä—É–∫–∏, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—è —Ç—Ä–∞–≥–∏—á–µ—Å–∫—É—é –≥–∏–±–µ–ª—å –∞–¥–º–∏—Ä–∞–ª–∞, –Ω–µ —É—Å–ø–µ–≤—à–µ–≥–æ –¥–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ—é –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∫–æ—Ä–æ–ª—é.",
                diagram="–ë—Ä–æ–Ω–µ–Ω–æ—Å–Ω—ã–π –∫–æ—Ä–∞–±–ª—å (–∫–æ–±—É–∫—Å–æ–Ω)",
                keywords=["—á—É–Ω–≥-–º—É", "–ª–∏ —Å—É–Ω —Å–∏–Ω", "–∞–¥–º–∏—Ä–∞–ª", "30 –¥–≤–∏–∂–µ–Ω–∏–π", "–∫–æ–±—É–∫—Å–æ–Ω"]
            ),

            # 1 –¥–∞–Ω
            TulInfo(
                name="–ö–≤–∞–Ω-–ì–µ",
                korean_name="Í¥ëÍ∞ú",
                belt="1 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=39,
                meaning="–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å 19-–≥–æ –∫–æ—Ä–æ–ª—è –ö–æ–≥—É—Ä—ë –ö–≤–∞–Ω–≥—ç—Ç—Ö–æ –í–µ–ª–∏–∫–æ–≥–æ (374-413), –≤–µ—Ä–Ω—É–≤—à–µ–≥–æ —É—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏. 39 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –ø–µ—Ä–≤—ã–µ –¥–≤–µ —Ü–∏—Ñ—Ä—ã –≥–æ–¥–∞ 391, –∫–æ–≥–¥–∞ –æ–Ω –≤–∑–æ—à–µ–ª –Ω–∞ —Ç—Ä–æ–Ω.",
                diagram="–†–∞—Å—à–∏—Ä—è—é—â–∞—è—Å—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è",
                keywords=["–∫–≤–∞–Ω-–≥–µ", "–∫–≤–∞–Ω–≥—ç—Ç—Ö–æ", "39 –¥–≤–∏–∂–µ–Ω–∏–π", "—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ", "–∫–æ—Ä–æ–ª—å –∫–æ–≥—É—Ä—ë"]
            ),
            TulInfo(
                name="–ü–æ-–£–Ω",
                korean_name="Ìè¨ÏùÄ",
                belt="1 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=36,
                meaning="–í–µ—Ä–Ω—ã–π —É—á–µ–Ω—ã–π",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –ø–æ—ç—Ç–∞ –ß–æ–Ω –ú–æ–Ω –î–∂—É (1337-1392), –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–æ–¥ –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º '–ü–æ-–£–Ω'. –ï–≥–æ —Å—Ç–∏—Ö '–Ø –Ω–µ –±—É–¥—É —Å–ª—É–∂–∏—Ç—å –≤—Ç–æ—Ä–æ–º—É –≥–æ—Å–ø–æ–¥–∏–Ω—É, –¥–∞–∂–µ –µ—Å–ª–∏ –º–µ–Ω—è –∫–∞–∑–Ω—è—Ç —Å—Ç–æ —Ä–∞–∑' —Å—Ç–∞–ª —Å–∏–º–≤–æ–ª–æ–º –≤–µ—Ä–Ω–æ—Å—Ç–∏.",
                diagram="–°—Ç–æ–π–∫–∞ –≤–µ—Ä–Ω–æ—Å—Ç–∏",
                keywords=["–ø–æ-—É–Ω", "—á–æ–Ω –º–æ–Ω –¥–∂—É", "–ø–æ—ç—Ç", "36 –¥–≤–∏–∂–µ–Ω–∏–π", "–≤–µ—Ä–Ω–æ—Å—Ç—å"]
            ),
            TulInfo(
                name="–ì–µ-–ë–µ–∫",
                korean_name="Í≥ÑÎ∞±",
                belt="1 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=44,
                meaning="–°—Ç—Ä–æ–≥–∏–π –∫–æ–º–∞–Ω–¥–∏—Ä",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –ö—ç–±—ç–∫–∞ (?-660) –¥–∏–Ω–∞—Å—Ç–∏–∏ –ü—ç–∫—á–µ, –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Å—Ç—Ä–æ–≥–æ–π –≤–æ–µ–Ω–Ω–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–æ–π. –ü–æ–≥–∏–± –≤ –±–∏—Ç–≤–µ –ø—Ä–∏ –•–≤–∞–Ω—Å–∞–Ω–µ, —Å—Ä–∞–∂–∞—è—Å—å –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–ª–¥–∞—Ç–∞.",
                diagram="–°—Ç—Ä–æ–≥–∏–µ –ª–∏–Ω–∏–∏ (–≤–æ–µ–Ω–Ω–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞)",
                keywords=["–≥–µ-–±–µ–∫", "–∫—ç–±—ç–∫", "–≥–µ–Ω–µ—Ä–∞–ª", "44 –¥–≤–∏–∂–µ–Ω–∏—è", "–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞"]
            ),
            # 2 –¥–∞–Ω
            TulInfo(
                name="–´–π-–ê–º",
                korean_name="ÏùòÏïî",
                belt="2 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=45,
                meaning="–ü–∞—Ç—Ä–∏–æ—Ç-–º—ã—Å–ª–∏—Ç–µ–ª—å",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –ª–∏–¥–µ—Ä–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ö–æ—Ä–µ–∏ –°–æ–Ω –ë—ë–Ω –•–∏ (1861-1922), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–µ–≥–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º '–´–π-–ê–º'. 45 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç –≤ 1905 –≥–æ–¥—É.",
                diagram="–°–∏–º–≤–æ–ª –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏",
                keywords=["—ã–π-–∞–º", "—Å–æ–Ω –±—ë–Ω —Ö–∏", "45 –¥–≤–∏–∂–µ–Ω–∏–π", "–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å", "–¥–≤–∏–∂–µ–Ω–∏–µ 1 –º–∞—Ä—Ç–∞"]
            ),
            TulInfo(
                name="–î–∂—É-–î–∂–∞–Ω–≥",
                korean_name="Ï∂©Ïû•",
                belt="2 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=52,
                meaning="–í–µ—Ä–Ω—ã–π –≥–µ–Ω–µ—Ä–∞–ª",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –ö–∏–º –î–∂–æ–Ω –°–æ (?-1388) –¥–∏–Ω–∞—Å—Ç–∏–∏ –ö–æ—Ä—ë. –¢—É–ª—å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —É–¥–∞—Ä–æ–º –ª–µ–≤–æ–π —Ä—É–∫–∏, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—è –µ–≥–æ —Ç—Ä–∞–≥–∏—á–µ—Å–∫—É—é —Å–º–µ—Ä—Ç—å –≤ —Ç—é—Ä—å–º–µ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ 27 –ª–µ—Ç.",
                diagram="–¢—Ä–∞–≥–∏—á–µ—Å–∫–∏–π —Ñ–∏–Ω–∞–ª",
                keywords=["–¥–∂—É-–¥–∂–∞–Ω–≥", "–∫–∏–º –¥–∂–æ–Ω —Å–æ", "52 –¥–≤–∏–∂–µ–Ω–∏—è", "–≥–µ–Ω–µ—Ä–∞–ª", "—Ç—Ä–∞–≥–µ–¥–∏—è"]
            ),
            TulInfo(
                name="–î–∂—É-–ß–µ",
                korean_name="Ï£ºÏ≤¥",
                belt="2 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=45,
                meaning="–•–æ–∑—è–∏–Ω —Å–≤–æ–µ–π —Å—É–¥—å–±—ã",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–æ–π –∏–¥–µ–∏ '—á—É—á—Ö–µ' (–æ–ø–æ—Ä–∞ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–ª—ã). –°–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –≥–æ—Ä—É –ü—ç–∫—Ç—É—Å–∞–Ω, —Å—á–∏—Ç–∞—é—â—É—é—Å—è –¥—É—Ö–æ–≤–Ω–æ–π –∫–æ–ª—ã–±–µ–ª—å—é –∫–æ—Ä–µ–π—Å–∫–æ–≥–æ –Ω–∞—Ä–æ–¥–∞.",
                diagram="–ì–æ—Ä–∞ –ü—ç–∫—Ç—É—Å–∞–Ω",
                keywords=["–¥–∂—É-—á–µ", "—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "45 –¥–≤–∏–∂–µ–Ω–∏–π", "–ø—ç–∫—Ç—É—Å–∞–Ω", "—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è"]

            # 3 –¥–∞–Ω
            ),
            TulInfo(
                name="–°–∞–º-–ò–ª",
                korean_name="ÏÇºÏùº",
                belt="3 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=33,
                meaning="–ü–µ—Ä–≤–æ–µ –º–∞—Ä—Ç–∞",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –î–≤–∏–∂–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –º–∞—Ä—Ç–∞ 1919 –≥–æ–¥–∞ –∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ö–æ—Ä–µ–∏. 33 –¥–≤–∏–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 33 –ø–∞—Ç—Ä–∏–æ—Ç–∞, –ø–æ–¥–ø–∏—Å–∞–≤—à–∏—Ö –î–µ–∫–ª–∞—Ä–∞—Ü–∏—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.",
                diagram="–î–∞—Ç–∞ 1 –º–∞—Ä—Ç–∞",
                keywords=["—Å–∞–º-–∏–ª", "1 –º–∞—Ä—Ç–∞", "33 –¥–≤–∏–∂–µ–Ω–∏—è", "–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å", "1919"]
            ),
            TulInfo(
                name="–Æ-–°–∏–Ω",
                korean_name="Ïú†Ïã†",
                belt="3 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=68,
                meaning="–í–µ—Ä–Ω—ã–π –≥–µ–Ω–µ—Ä–∞–ª",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –ö–∏–º –Æ –°–∏–Ω–∞ (595-673) –¥–∏–Ω–∞—Å—Ç–∏–∏ –°–∏–ª–ª–∞. 68 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–∏—Ñ—Ä—ã 668 –≥–æ–¥–∞ - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ö–æ—Ä–µ–∏. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–æ–∑–∏—Ü–∏–∏ —Å –º–µ—á–æ–º –≤ –ø—Ä–∞–≤–æ–π —Ä—É–∫–µ, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—è –µ–≥–æ –æ—à–∏–±–∫—É —Å–ª–µ–¥–æ–≤–∞—Ç—å —á—É–∂–∏–º –≤–æ–π—Å–∫–∞–º.",
                diagram="–ú–µ—á –≤ –ø—Ä–∞–≤–æ–π —Ä—É–∫–µ",
                keywords=["—é-—Å–∏–Ω", "–∫–∏–º —é —Å–∏–Ω", "68 –¥–≤–∏–∂–µ–Ω–∏–π", "–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ", "–≥–µ–Ω–µ—Ä–∞–ª"]
            ),
            TulInfo(
                name="–ß–æ–π-–Å–Ω–≥",
                korean_name="ÏµúÏòÅ",
                belt="3 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=46,
                meaning="–ü–∞—Ç—Ä–∏–æ—Ç-–≥—É–º–∞–Ω–∏—Å—Ç",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –ß—Ö–≤–µ –Å–Ω–∞ (1316-1388) –¥–∏–Ω–∞—Å—Ç–∏–∏ –ö–æ—Ä—ë. –ò–∑–≤–µ—Å—Ç–µ–Ω –≤–µ—Ä–Ω–æ—Å—Ç—å—é, –ø–∞—Ç—Ä–∏–æ—Ç–∏–∑–º–æ–º –∏ –≥—É–º–∞–Ω–∏–∑–º–æ–º. –ö–∞–∑–Ω–µ–Ω —Å–≤–æ–∏–º–∏ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–º–∏ –ø–æ –ø—Ä–∏–∫–∞–∑—É –õ–∏ –°–æ–Ω –ì–µ.",
                diagram="–°–∏–º–≤–æ–ª –≤–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–∞–≥–µ–¥–∏–∏",
                keywords=["—á–æ–π-—ë–Ω–≥", "—á—Ö–≤–µ —ë–Ω", "46 –¥–≤–∏–∂–µ–Ω–∏–π", "–≤–µ—Ä–Ω–æ—Å—Ç—å", "—Ç—Ä–∞–≥–µ–¥–∏—è"]
            ),

            # 4 –¥–∞–Ω
            TulInfo(
                name="–ô–æ–≥-–ì–µ",
                korean_name="ÏòÅÍ∞ú",
                belt="4 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=49,
                meaning="–ü–æ–±–µ–¥–∏—Ç–µ–ª—å",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –ô–æ–≥ –ì–µ –°–æ–º—É–Ω (?-665) –¥–∏–Ω–∞—Å—Ç–∏–∏ –ö–æ–≥—É—Ä—ë. 49 –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–∏—Ñ—Ä—ã 649 –≥–æ–¥–∞, –∫–æ–≥–¥–∞ –æ–Ω —Ä–∞–∑–±–∏–ª –≤–æ–π—Å–∫–∞ –¥–∏–Ω–∞—Å—Ç–∏–∏ –¢–∞–Ω.",
                diagram="–ü–æ–±–µ–¥–æ–Ω–æ—Å–Ω–æ–µ —Å—Ä–∞–∂–µ–Ω–∏–µ",
                keywords=["–π–æ–≥-–≥–µ", "–π–æ–≥ –≥–µ —Å–æ–º—É–Ω", "49 –¥–≤–∏–∂–µ–Ω–∏–π", "–ø–æ–±–µ–¥–∞", "–¥–∏–Ω–∞—Å—Ç–∏—è —Ç–∞–Ω"]
            ),
            TulInfo(
                name="–£–ª—å-–ß–∂–∏",
                korean_name="ÏùÑÏßÄ",
                belt="4 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=42,
                meaning="–ì–µ–Ω–∏–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞–ª–∞ –´–ª—å—á–∏ –ú—É–Ω–¥–æ–∫–∞ (?-?), —É—Å–ø–µ—à–Ω–æ –∑–∞—â–∏—Ç–∏–≤—à–µ–≥–æ –ö–æ–≥—É—Ä—ë –æ—Ç –º–∏–ª–ª–∏–æ–Ω–Ω–æ–π –∞—Ä–º–∏–∏ –¥–∏–Ω–∞—Å—Ç–∏–∏ –¢–∞–Ω. 42 –¥–≤–∏–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –≤–æ–∑—Ä–∞—Å—Ç –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—è —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ, –∫–æ–≥–¥–∞ –æ–Ω —Å–æ–∑–¥–∞–ª —ç—Ç–æ—Ç —Ç—É–ª—å.",
                diagram="–ì–µ–Ω–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è",
                keywords=["—É–ª—å-—á–∂–∏", "—ã–ª—å—á–∏ –º—É–Ω–¥–æ–∫", "42 –¥–≤–∏–∂–µ–Ω–∏—è", "—Å—Ç—Ä–∞—Ç–µ–≥–∏—è", "–æ–±–æ—Ä–æ–Ω–∞"]
            ),
            TulInfo(
                name="–ú—É–Ω-–ú—É",
                korean_name="Î¨∏Î¨¥",
                belt="4 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=61,
                meaning="–ö–æ—Ä–æ–ª—å-–∑–∞—â–∏—Ç–Ω–∏–∫",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å 30-–≥–æ –∫–æ—Ä–æ–ª—è –°–∏–ª–ª—ã –ú—É–Ω–º—É –í–µ–ª–∏–∫–æ–≥–æ (626-681). 61 –¥–≤–∏–∂–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 661 –≥–æ–¥ - –Ω–∞—á–∞–ª–æ –µ–≥–æ –ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ü–æ –µ–≥–æ –∑–∞–≤–µ—â–∞–Ω–∏—é, —Ç–µ–ª–æ –ø–æ—Ö–æ—Ä–æ–Ω–∏–ª–∏ –≤ –º–æ—Ä–µ, —á—Ç–æ–±—ã –¥—É—à–∞ –∑–∞—â–∏—â–∞–ª–∞ –ö–æ—Ä–µ—é –æ—Ç —è–ø–æ–Ω—Ü–µ–≤.",
                diagram="–ó–∞—â–∏—Ç–∞ —Å –º–æ—Ä—è",
                keywords=["–º—É–Ω-–º—É", "–∫–æ—Ä–æ–ª—å –º—É–Ω–º—É", "61 –¥–≤–∏–∂–µ–Ω–∏–µ", "–∑–∞—â–∏—Ç–Ω–∏–∫", "–º–æ—Ä–µ"]
            ),
            # 5 –¥–∞–Ω
            TulInfo(
                name="–°–æ-–°–∞–Ω",
                korean_name="ÏÑúÏÇ∞",
                belt="5 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=72,
                meaning="–í–æ–∏–Ω—Å—Ç–≤—É—é—â–∏–π –º–æ–Ω–∞—Ö",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –º–æ–Ω–∞—Ö–∞ –°–æ—Å–∞–Ω–∞ (1520-1604), –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–≤—à–µ–≥–æ –æ—Ç—Ä—è–¥—ã –º–æ–Ω–∞—Ö–æ–≤-–≤–æ–∏–Ω–æ–≤. 72 –¥–≤–∏–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç –µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç—Ä—è–¥–æ–≤. –û—Ç—Ä—è–¥—ã —É—Å–ø–µ—à–Ω–æ –±–æ—Ä–æ–ª–∏—Å—å —Å —è–ø–æ–Ω—Å–∫–∏–º–∏ –ø–∏—Ä–∞—Ç–∞–º–∏.",
                diagram="–ú–æ–Ω–∞—Ö-–≤–æ–∏–Ω",
                keywords=["—Å–æ-—Å–∞–Ω", "–º–æ–Ω–∞—Ö", "72 –¥–≤–∏–∂–µ–Ω–∏—è", "–≤–æ–∏–Ω—ã-–º–æ–Ω–∞—Ö–∏", "–∑–∞—â–∏—Ç–∞"]
            ),
            TulInfo(
                name="–°–µ-–ß–∂–æ–Ω–≥",
                korean_name="ÏÑ∏Ï¢Ö",
                belt="5 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=24,
                meaning="–ö–æ—Ä–æ–ª—å-—Å–æ–∑–¥–∞—Ç–µ–ª—å",
                history="–ù–∞–∑–≤–∞–Ω –≤ —á–µ—Å—Ç—å –∫–æ—Ä–æ–ª—è –°–µ—á–∂–æ–Ω–∞ –í–µ–ª–∏–∫–æ–≥–æ (1397-1450), —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –∫–æ—Ä–µ–π—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç —Ö–∞–Ω–≥—ã–ª—å –≤ 1443 –≥–æ–¥—É. 24 –¥–≤–∏–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 24 –±—É–∫–≤—ã –∞–ª—Ñ–∞–≤–∏—Ç–∞.",
                diagram="–ö–æ—Ä–µ–π—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç",
                keywords=["—Å–µ-—á–∂–æ–Ω–≥", "—Å–µ—á–∂–æ–Ω –≤–µ–ª–∏–∫–∏–π", "24 –¥–≤–∏–∂–µ–Ω–∏—è", "—Ö–∞–Ω–≥—ã–ª—å", "–∞–ª—Ñ–∞–≤–∏—Ç"]
            ),
            # 6 –¥–∞–Ω
            TulInfo(
                name="–¢–æ–Ω–≥-–ò–ª",
                korean_name="ÌÜµÏùº",
                belt="6 –¥–∞–Ω (—á–µ—Ä–Ω—ã–π –ø–æ—è—Å)",
                movements=56,
                meaning="–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ",
                history="–°–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ö–æ—Ä–µ–∏, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω–æ–π –≤ 1945 –≥–æ–¥—É. –í—ã—Ä–∞–∂–∞–µ—Ç –Ω–∞–¥–µ–∂–¥—É –Ω–∞ –≤–æ—Å—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–µ–≤–µ—Ä–Ω–æ–π –∏ —é–∂–Ω–æ–π —á–∞—Å—Ç–µ–π –ö–æ—Ä–µ–∏.",
                diagram="–ï–¥–∏–Ω–∞—è –ö–æ—Ä–µ—è",
                keywords=["—Ç–æ–Ω–≥-–∏–ª", "–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ", "56 –¥–≤–∏–∂–µ–Ω–∏–π", "–µ–¥–∏–Ω–∞—è –∫–æ—Ä–µ—è", "–≤–æ—Å—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ"]
            )
        ]

        return tuls_data

    def _load_belts_system(self) -> Dict:
        """–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø–æ—è—Å–æ–≤"""
        belts = {
            "10_gup": {
                "name": "10 –≥—ã–ø",
                "color": "–ë–µ–ª—ã–π –ø–æ—è—Å",
                "description": "–ß–∏—Å—Ç–æ –±–µ–ª—ã–π, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ—Ç—É –∏ –Ω–µ–≤–∏–Ω–Ω–æ—Å—Ç—å —É—á–µ–Ω–∏–∫–∞",
                "tuls": ["–°–∞–¥–∂—É-–ß–∞—Ä–∏–≥–∏", "–°–∞–¥–∂—É-–ú–∞–∫–∫–∏"],
                "duration": "1-2 –º–µ—Å—è—Ü–∞",
                "requirements": "–ë–∞–∑–æ–≤—ã–µ —Å—Ç–æ–π–∫–∏, —É–¥–∞—Ä—ã, –±–ª–æ–∫–∏, —ç—Ç–∏–∫–µ—Ç"
            },
            "9_gup": {
                "name": "9 –≥—ã–ø",
                "color": "–ë–µ–ª—ã–π —Å –∂–µ–ª—Ç–æ–π –ø–æ–ª–æ—Å–∫–æ–π",
                "description": "–ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –ø–µ—Ä–≤—ã–µ —à–∞–≥–∏",
                "tuls": ["–ß–æ–Ω-–î–∂–∏"],
                "duration": "2-3 –º–µ—Å—è—Ü–∞",
                "requirements": "–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, –ø–µ—Ä–≤—ã–π —Ç—É–ª—å"
            },
            "8_gup": {
                "name": "8 –≥—ã–ø",
                "color": "–ñ–µ–ª—Ç—ã–π –ø–æ—è—Å",
                "description": "–ñ–µ–ª—Ç—ã–π - —Ü–≤–µ—Ç –∑–µ–º–ª–∏, –≥–¥–µ —É–∫–æ—Ä–µ–Ω—è—é—Ç—Å—è –∑–Ω–∞–Ω–∏—è",
                "tuls": ["–î–∞–Ω-–ì—É–Ω"],
                "duration": "3-4 –º–µ—Å—è—Ü–∞",
                "requirements": "–£–ª—É—á—à–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏, —Å–ø–∞—Ä—Ä–∏–Ω–≥"
            },
            "7_gup": {
                "name": "7 –≥—ã–ø",
                "color": "–ñ–µ–ª—Ç—ã–π —Å –∑–µ–ª–µ–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π",
                "description": "–ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π —ç—Ç–∞–ø, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–µ–ª–µ–Ω–æ–º—É –ø–æ—è—Å—É",
                "tuls": ["–î–æ-–°–∞–Ω"],
                "duration": "3-4 –º–µ—Å—è—Ü–∞",
                "requirements": "–ö–æ–º–±–∏–Ω–∞—Ü–∏–∏, —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫"
            },
            "6_gup": {
                "name": "6 –≥—ã–ø",
                "color": "–ó–µ–ª–µ–Ω—ã–π –ø–æ—è—Å",
                "description": "–ó–µ–ª–µ–Ω—ã–π - —Ü–≤–µ—Ç —Ä–æ—Å—Ç–∞ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è",
                "tuls": ["–í–æ–Ω-–•—å—ë"],
                "duration": "4-6 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–°–∫–æ—Ä–æ—Å—Ç—å, —Ç–æ—á–Ω–æ—Å—Ç—å, —Å–ª–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏"
            },
            "5_gup": {
                "name": "5 –≥—ã–ø",
                "color": "–ó–µ–ª–µ–Ω—ã–π —Å —Å–∏–Ω–µ–π –ø–æ–ª–æ—Å–∫–æ–π",
                "description": "–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ —Å–∏–Ω–µ–º—É –ø–æ—è—Å—É, —Ä–∞–∑–≤–∏—Ç–∏–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞",
                "tuls": ["–Æ–ª—å-–ì–æ–∫"],
                "duration": "4-6 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–°–∏–ª–∞, –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å, —Ç–∞–∫—Ç–∏–∫–∞"
            },
            "4_gup": {
                "name": "4 –≥—ã–ø",
                "color": "–°–∏–Ω–∏–π –ø–æ—è—Å",
                "description": "–°–∏–Ω–∏–π - —Ü–≤–µ—Ç –Ω–µ–±–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É —Å—Ç—Ä–µ–º–∏—Ç—Å—è —É—á–µ–Ω–∏–∫",
                "tuls": ["–î–∂—É–Ω-–ì—É–Ω"],
                "duration": "6-8 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–°–ª–æ–∂–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏"
            },
            "3_gup": {
                "name": "3 –≥—ã–ø",
                "color": "–°–∏–Ω–∏–π —Å –∫—Ä–∞—Å–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π",
                "description": "–ü–µ—Ä–µ—Ö–æ–¥ –∫ –∫—Ä–∞—Å–Ω–æ–º—É –ø–æ—è—Å—É, —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ",
                "tuls": ["–¢—ç—ë-–ì—ç"],
                "duration": "6-8 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, –∫–æ–Ω—Ç—Ä–æ–ª—å, –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤"
            },
            "2_gup": {
                "name": "2 –≥—ã–ø",
                "color": "–ö—Ä–∞—Å–Ω—ã–π –ø–æ—è—Å",
                "description": "–ö—Ä–∞—Å–Ω—ã–π - —Ü–≤–µ—Ç –æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Å–∏–ª–µ",
                "tuls": ["–•–≤–∞-–†–∞–Ω–≥"],
                "duration": "8-12 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–í—ã—Å–æ–∫–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏–µ"
            },
            "1_gup": {
                "name": "1 –≥—ã–ø",
                "color": "–ö—Ä–∞—Å–Ω—ã–π —Å —á–µ—Ä–Ω–æ–π –ø–æ–ª–æ—Å–∫–æ–π",
                "description": "–ü–æ—Å–ª–µ–¥–Ω–∏–π —É—á–µ–Ω–∏—á–µ—Å–∫–∏–π –ø–æ—è—Å, –ø–µ—Ä–µ—Ö–æ–¥ –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É",
                "tuls": ["–ß—É–Ω–≥-–ú—É"],
                "duration": "8-12 –º–µ—Å—è—Ü–µ–≤",
                "requirements": "–ü–æ–ª–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–æ–π, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —á–µ—Ä–Ω–æ–º—É –ø–æ—è—Å—É"
            },
            "1_dan": {
                "name": "1 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–ü–æ–º–æ—â–Ω–∏–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ (Boo-sabum)",
                "tuls": ["–ö–≤–∞–Ω-–ì–µ", "–ü–æ-–£–Ω", "–ì–µ-–ë–µ–∫"],
                "duration": "1-2 –≥–æ–¥–∞",
                "requirements": "–ü—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏–µ, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ"
            },
            "2_dan": {
                "name": "2 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (Sabum)",
                "tuls": ["–´–π-–ê–º", "–î–∂—É-–î–∂–∞–Ω–≥", "–î–∂—É-–ß–µ"],
                "duration": "2 –≥–æ–¥–∞",
                "requirements": "–£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏–µ, —Å—É–¥–µ–π—Å—Ç–≤–æ"
            },
            "3_dan": {
                "name": "3 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (Sabum)",
                "tuls": ["–°–∞–º-–ò–ª", "–Æ-–°–∏–Ω", "–ß–æ–π-–Å–Ω–≥"],
                "duration": "3 –≥–æ–¥–∞",
                "requirements": "–í—ã—Å–æ–∫–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤"
            },
            "4_dan": {
                "name": "4 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–ú–∞—Å—Ç–µ—Ä (Sahyun)",
                "tuls": ["–ô–æ–≥-–ì–µ", "–£–ª—å-–ß–∂–∏", "–ú—É–Ω-–ú—É"],
                "duration": "4 –≥–æ–¥–∞",
                "requirements": "–í—ã—Å—à–µ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, —Ä–∞–∑–≤–∏—Ç–∏–µ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ"
            },
            "5_dan": {
                "name": "5 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–ú–∞—Å—Ç–µ—Ä (Sahyun)",
                "tuls": ["–°–æ-–°–∞–Ω", "–°–µ-–ß–∂–æ–Ω–≥"],
                "duration": "5 –ª–µ—Ç",
                "requirements": "–í–∫–ª–∞–¥ –≤ —Ä–∞–∑–≤–∏—Ç–∏–µ, –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ"
            },
            "6_dan": {
                "name": "6 –¥–∞–Ω",
                "color": "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å",
                "description": "–í–µ–ª–∏–∫–∏–π –º–∞—Å—Ç–µ—Ä (Saseong)",
                "tuls": ["–¢–æ–Ω–≥-–ò–ª"],
                "duration": "6 –ª–µ—Ç",
                "requirements": "–í—ã–¥–∞—é—â–∏–π—Å—è –≤–∫–ª–∞–¥, –Ω–∞—Å–ª–µ–¥–∏–µ"
            }
        }

        return belts

    def _load_techniques(self) -> Dict:
        """–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ö–Ω–∏–∫ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤"""
        techniques = {
            "–°—Ç–æ–π–∫–∏ –≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ": {
                "–ù–∞—Ä–∞–Ω–∏ —Å–æ–≥–∏": "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å—Ç–æ–π–∫–∞, –Ω–æ–≥–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á",
                "–ß–∞—Ä—ë—Ç —Å–æ–≥–∏": "–°—Ç–æ–π–∫–∞ ¬´—Å–º–∏—Ä–Ω–æ¬ª.",
                "–ì—É–Ω–Ω—É–Ω —Å–æ–≥–∏": "–ó–∞–¥–Ω—è—è —Å—Ç–æ–π–∫–∞, 70% –≤–µ—Å–∞ –Ω–∞ –∑–∞–¥–Ω–µ–π –Ω–æ–≥–µ",
                "–ê–Ω–Ω—É–Ω —Å–æ–≥–∏": "C—Ç–æ–π–∫–∞ –≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§, —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–æ–π–∫–æ–π ¬´–≤—Å–∞–¥–Ω–∏–∫–∞¬ª. –ù–∞–∑–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –ø–æ–∑–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ñ–æ—Ä–º—É –Ω–æ–≥ —á–µ–ª–æ–≤–µ–∫–∞ –≤–æ –≤—Ä–µ–º—è –µ–∑–¥—ã –Ω–∞ –ª–æ—à–∞–¥–∏.",
                "–ê–ø —Å–æ–≥–∏": "–ü–µ—Ä–µ–¥–Ω—è—è –≤—ã—Å–æ–∫–∞—è —Å—Ç–æ–π–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–¥–Ω–∞ –Ω–æ–≥–∞ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤–ø–µ—Ä—ë–¥, –∫–∞–∫ –ø—Ä–∏ –æ–±—ã—á–Ω–æ–π —Ö–æ–¥—å–±–µ, –∞ –æ–±–µ –Ω–æ–≥–∏ –≤—ã–ø—Ä—è–º–ª–µ–Ω—ã. ",
                "–î–≤–∏—Ç–∫—É–±–∏ —Å–æ–≥–∏": "L-–æ–±—Ä–∞–∑–Ω–∞—è —Å—Ç–æ–π–∫–∞, –æ–¥–Ω–∞ –Ω–æ–≥–∞ —Å–æ–≥–Ω—É—Ç–∞, –¥—Ä—É–≥–∞—è –ø—Ä—è–º–∞—è"
            },
            "–£–¥–∞—Ä—ã –Ω–æ–≥–∞–º–∏": {
                "–ê–ø —á–∞–≥–∏": "–ü—Ä—è–º–æ–π —É–¥–∞—Ä –Ω–æ–≥–æ–π –≤–ø–µ—Ä–µ–¥",
                "–ô–æ–ø —á–∞–≥–∏": "–ë–æ–∫–æ–≤–æ–π —É–¥–∞—Ä –Ω–æ–≥–æ–π",
                "–¢–≤–∏—Ç —á–∞–≥–∏": "–ö—Ä—É–≥–æ–≤–æ–π —É–¥–∞—Ä –Ω–æ–≥–æ–π",
                "–î–æ–ª—å—ë —á–∞–≥–∏": "–£–¥–∞—Ä –Ω–æ–≥–æ–π —Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞",
                "–ë–∞–Ω–¥–∞–ª—å —á–∞–≥–∏": "–ü–æ–ª—É–∫—Ä—É–≥–æ–≤–æ–π —É–¥–∞—Ä –Ω–æ–≥–æ–π"
            },
            "–£–¥–∞—Ä—ã —Ä—É–∫–æ–π": {
                "–ß—É–º–æ–∫": "–ü—Ä—è–º–æ–π —É–¥–∞—Ä –∫—É–ª–∞–∫–æ–º",
                "–ß–∏—Ä—É–≥–∏": "–£–¥–∞—Ä –∫–æ–Ω—á–∏–∫–∞–º–∏ –ø–∞–ª—å—Ü–µ–≤",
                "–ô–æ–ø —á–∏—Ä—É–≥–∏": "–ë–æ–∫–æ–≤–æ–π —É–¥–∞—Ä —Ä—É–∫–æ–π",
                "–ü—å—ë–Ω —á—É–º–æ–∫": "–£–¥–∞—Ä –∫—É–ª–∞–∫–æ–º —Å–±–æ–∫—É"
            },
            "–ë–ª–æ–∫–∏ —Ä—É–∫–∞–º–∏": {
                "–ê—Ä–µ –º–∞–∫–∫–∏": "–ù–∏–∂–Ω–∏–π –±–ª–æ–∫",
                "–û–ª—å–≥—É–ª—å –º–∞–∫–∫–∏": "–í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫",
                "–•—ç—á–∂–æ –º–∞–∫–∫–∏": "–î–≤–æ–π–Ω–æ–π –±–ª–æ–∫",
                "–ú–æ–º—Ç–æ–º –º–∞–∫–∫–∏": "–ë–ª–æ–∫ —Ç—É–ª–æ–≤–∏—â–∞"
            },
            "–î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –Ω–∞ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è—Ö": {
                "–¢—É–ª—å": "–ö–æ–º–ø–ª–µ–∫—Å –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞—Ç–∞–∫—É—é—â–∏—Ö –∏ –∑–∞—â–∏—Ç–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –ª–æ–≥–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ó–∞–Ω–∏–º–∞—é—â–∏–π—Å—è –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø–æ–µ–¥–∏–Ω–æ–∫ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞–º–∏, –≤—ã–ø–æ–ª–Ω—è—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Ç–∞–∫—É—é—â–∏–µ –∏ –∑–∞—â–∏—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ ¬´—Å–∫–ª–∞–¥—ã–≤–∞—é—â–µ–π—Å—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–µ¬ª.",
                "–ú–∞—Å—Å–æ–≥–∏": "–°–ø–∞—Ä—Ä–∏–Ω–≥, –ø–æ–µ–¥–∏–Ω–æ–∫, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —É–º–µ–Ω–∏—è –∏ –Ω–∞–≤—ã–∫–∏, –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω—ã–µ –ø—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ –±–∞–∑–æ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–∏. –ß–∞—Å—Ç—å —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –ø–æ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§. –ù–∞ –∫—Ä—É–ø–Ω—ã—Ö —á–µ–º–ø–∏–æ–Ω–∞—Ç–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –∏ –∫–æ–º–∞–Ω–¥–Ω–æ–µ –ø–µ—Ä–≤–µ–Ω—Å—Ç–≤–æ, –≤ –æ–±—ã—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ ‚Äî —Ç–æ–ª—å–∫–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –ø–µ—Ä–≤–µ–Ω—Å—Ç–≤–æ.",
                "–°–∏–ª–æ–≤–æ–µ —Ä–∞–∑–±–∏–≤–∞–Ω–∏–µ (power breaking)": "–°–ø–æ—Ä—Ç—Å–º–µ–Ω—ã —Ä–∞–∑–±–∏–≤–∞—é—Ç –¥–æ—Å–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (30√ó30√ó1,5 —Å–º), –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º —Å—Ç–∞–Ω–∫–µ. –ó–∞–¥–∞—á–∞ ‚Äî —Ä–∞–∑–±–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –¥–æ—Å–æ–∫ –∑–∞ 1 —É–¥–∞—Ä. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å–æ–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.",
                "–°–∞–º–æ–æ–±–æ—Ä–æ–Ω–∞": " –∑–∞—â–∏—Ç–∏—Ç—å —Å–µ–±—è –≤ —Å–ª—É—á–∞–µ –Ω–∞–ø–∞–¥–µ–Ω–∏—è –∏–ª–∏ –æ–ø–∞—Å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è—Ç—å –æ–¥–Ω–æ–º—É –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤—É –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤–æ–æ—Ä—É–∂—ë–Ω–Ω—ã–º.",
                "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞": "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ - —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ –ø—Ä—ã–∂–∫–µ —É–¥–∞—Ä—ã —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –≤—ã—Å–æ—Ç–µ –∏–ª–∏ –≤ –¥–ª–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É."
            }
        }

        return techniques

    def _create_complete_knowledge_base(self) -> Dict:
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π"""
        knowledge = {
            "tuls": {tul.name: asdict(tul) for tul in self.tuls},
            "belts": self.belts,
            "techniques": self.techniques,
            "statistics": {
                "total_tuls": len(self.tuls),
                "total_movements": sum(tul.movements for tul in self.tuls),
                "belt_levels": len(self.belts),
                "technique_categories": len(self.techniques)
            }
        }

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
        knowledge_file = os.path.join(self.data_dir, "complete_knowledge.json")
        try:
            with open(knowledge_file, 'w', encoding='utf-8') as f:
                json.dump(knowledge, f, ensure_ascii=False, indent=2)
            logger.info(f"–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: {knowledge_file}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π: {e}")

        return knowledge

    def get_tul_by_name(self, name: str) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É–ª–µ –ø–æ –∏–º–µ–Ω–∏"""
        for tul in self.tuls:
            if tul.name.lower() == name.lower():
                return asdict(tul)
        return None

    def get_tuls_by_belt(self, belt: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç—É–ª–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—è—Å–∞"""
        return [asdict(tul) for tul in self.tuls if tul.belt.lower() == belt.lower()]

    def get_belt_info(self, belt_key: str) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—è—Å–µ"""
        return self.belts.get(belt_key)

    def search_tuls(self, keyword: str) -> List[Dict]:
        """–ü–æ–∏—Å–∫ —Ç—É–ª–µ–π –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É"""
        results = []
        keyword_lower = keyword.lower()

        for tul in self.tuls:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
            if keyword_lower in tul.name.lower():
                results.append(asdict(tul))
                continue

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –∫–æ—Ä–µ–π—Å–∫–æ–º –Ω–∞–∑–≤–∞–Ω–∏–∏
            if keyword_lower in tul.korean_name.lower():
                results.append(asdict(tul))
                continue

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –∑–Ω–∞—á–µ–Ω–∏–∏
            if keyword_lower in tul.meaning.lower():
                results.append(asdict(tul))
                continue

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏–∏
            if keyword_lower in tul.history.lower():
                results.append(asdict(tul))
                continue

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤–∞—Ö
            if any(keyword_lower in kw.lower() for kw in tul.keywords):
                results.append(asdict(tul))
                continue

        return results

    def get_tul_progression(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é —Ç—É–ª–µ–π –ø–æ –ø–æ—è—Å–∞–º"""
        progression = []

        for belt_key, belt_info in self.belts.items():
            belt_tuls = []
            for tul_name in belt_info.get("tuls", []):
                tul = self.get_tul_by_name(tul_name)
                if tul:
                    belt_tuls.append({
                        "name": tul["name"],
                        "movements": tul["movements"],
                        "meaning": tul["meaning"]
                    })

            progression.append({
                "belt": belt_info["name"],
                "color": belt_info["color"],
                "tuls": belt_tuls,
                "duration": belt_info.get("duration", "")
            })

        return progression

    def get_random_tul_fact(self) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ç—É–ª–µ"""
        if not self.tuls:
            return "–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—É–ª—è—Ö."

        tul = random.choice(self.tuls)

        facts = [
            f"–¢—É–ª—å '{tul.name}' ({tul.korean_name}) —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ {tul.movements} –¥–≤–∏–∂–µ–Ω–∏–π.",
            f"–¢—É–ª—å '{tul.name}' –∏–∑—É—á–∞–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ {tul.belt}.",
            f"–ó–Ω–∞—á–µ–Ω–∏–µ —Ç—É–ª—è '{tul.name}': {tul.meaning}.",
            f"–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞: {tul.history[:250]}...",
            f"–¢—É–ª—å '{tul.name}' —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç: {tul.meaning}."
        ]

        return random.choice(facts)

    def get_belt_timeline(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É –ø–æ—è—Å–æ–≤"""
        timeline = []

        belt_order = [
            "10_gup", "9_gup", "8_gup", "7_gup", "6_gup", "5_gup",
            "4_gup", "3_gup", "2_gup", "1_gup", "1_dan", "2_dan",
            "3_dan", "4_dan", "5_dan", "6_dan"
        ]

        for i, belt_key in enumerate(belt_order):
            if belt_key in self.belts:
                belt_info = self.belts[belt_key]
                timeline.append({
                    "order": i + 1,
                    "belt": belt_info["name"],
                    "color": belt_info["color"],
                    "description": belt_info["description"],
                    "tuls_count": len(belt_info.get("tuls", []))
                })

        return timeline


class TaekwondoTulBot:
    """–ë–æ—Ç —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç—É–ª—è—Ö —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ"""

    def __init__(self):
        self.TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")
        if not self.TOKEN:
            raise ValueError("TELEGRAM_BOT_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω")

        self.knowledge = TaekwondoKnowledgeSystem()
        self.user_data = {}

    def get_main_menu(self) -> InlineKeyboardMarkup:
        """–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
        keyboard = [
            [
                InlineKeyboardButton("üåÄ –í—Å–µ —Ç—É–ª–∏", callback_data='all_tuls'),
                InlineKeyboardButton("üéΩ –ü–æ—è—Å–∞", callback_data='belts_system')
            ],
            [
                InlineKeyboardButton("üîç –ü–æ–∏—Å–∫ —Ç—É–ª—è", callback_data='search_tul'),
                InlineKeyboardButton("üìä –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –ø–æ –ø–æ—è—Å–∞–º", callback_data='tul_progression')
            ],
            [
                InlineKeyboardButton("üìö –¢–µ—Ö–Ω–∏–∫–∏", callback_data='techniques'),
                InlineKeyboardButton("üí° –§–∞–∫—Ç –æ —Ç—É–ª—è—Ö", callback_data='random_tul_fact')
            ],
            [
                InlineKeyboardButton("‚è≥ –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞", callback_data='belt_timeline'),
                InlineKeyboardButton("üÜò –ü–æ–º–æ—â—å", callback_data='help')
            ]
        ]
        return InlineKeyboardMarkup(keyboard)

    def get_tuls_menu(self) -> InlineKeyboardMarkup:
        """–ú–µ–Ω—é —Ç—É–ª–µ–π"""
        keyboard = []

        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ç—É–ª–∏ –ø–æ –ø–æ—è—Å–∞–º
        belt_groups = {}
        for tul in self.knowledge.tuls:
            belt = tul.belt
            if belt not in belt_groups:
                belt_groups[belt] = []
            belt_groups[belt].append(tul.name)

        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
        for belt, tuls in belt_groups.items():
            # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É –Ω–∞–∑–≤–∞–Ω–∏—è
            belt_short = belt[:20] + "..." if len(belt) > 20 else belt
            keyboard.append([InlineKeyboardButton(f"üìñ {belt_short}", callback_data=f'belt_{belt}')])

        keyboard.append([InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data='back_to_menu')])
        return InlineKeyboardMarkup(keyboard)

    def get_belts_menu(self) -> InlineKeyboardMarkup:
        """–ú–µ–Ω—é –ø–æ—è—Å–æ–≤"""
        keyboard = []

        belts_order = [
            ("10 –≥—ã–ø", "10_gup"),
            ("9 –≥—ã–ø", "9_gup"),
            ("8 –≥—ã–ø", "8_gup"),
            ("7 –≥—ã–ø", "7_gup"),
            ("6 –≥—ã–ø", "6_gup"),
            ("5 –≥—ã–ø", "5_gup"),
            ("4 –≥—ã–ø", "4_gup"),
            ("3 –≥—ã–ø", "3_gup"),
            ("2 –≥—ã–ø", "2_gup"),
            ("1 –≥—ã–ø", "1_gup"),
            ("1 –¥–∞–Ω", "1_dan"),
            ("2 –¥–∞–Ω", "2_dan"),
            ("3 –¥–∞–Ω", "3_dan"),
            ("4 –¥–∞–Ω", "4_dan"),
            ("5 –¥–∞–Ω", "5_dan"),
            ("6 –¥–∞–Ω", "6_dan")
        ]

        # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏
        for i in range(0, len(belts_order), 2):
            row = []
            if i < len(belts_order):
                name, key = belts_order[i]
                row.append(InlineKeyboardButton(f"üéΩ {name}", callback_data=f'belt_info_{key}'))
            if i + 1 < len(belts_order):
                name, key = belts_order[i + 1]
                row.append(InlineKeyboardButton(f"üéΩ {name}", callback_data=f'belt_info_{key}'))
            if row:
                keyboard.append(row)

        keyboard.append([InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data='back_to_menu')])
        return InlineKeyboardMarkup(keyboard)

    def get_back_menu(self) -> InlineKeyboardMarkup:
        """–ö–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥"""
        keyboard = [[InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data='back_to_menu')]]
        return InlineKeyboardMarkup(keyboard)

    async def start_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /start"""
        user = update.effective_user

        stats = self.knowledge.knowledge_base["statistics"]

        welcome_text = f"""
ü•ã <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§!</b>

–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ —Ç—É–ª–µ–π –∏ –ø–æ—è—Å–æ–≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ.

<u><b>–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç:</b></u>
‚Ä¢ {stats['total_tuls']} —Ç—É–ª–µ–π
‚Ä¢ {stats['total_movements']} –¥–≤–∏–∂–µ–Ω–∏–π
‚Ä¢ {stats['belt_levels']} —É—Ä–æ–≤–Ω–µ–π –ø–æ—è—Å–æ–≤
‚Ä¢ {stats['technique_categories']} –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–µ—Ö–Ω–∏–∫

<u><b>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:</b></u>
üåÄ <b>–í—Å–µ —Ç—É–ª–∏</b> - –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Å–æ–≤
üéΩ <b>–ü–æ—è—Å–∞</b> - —Å–∏—Å—Ç–µ–º–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
üîç <b>–ü–æ–∏—Å–∫ —Ç—É–ª–µ–π</b> - –Ω–∞–π—Ç–∏ —Ç—É–ª –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
üìä <b>–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –ø–æ –ø–æ—è—Å–∞–º</b> - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑—É—á–µ–Ω–∏—è —Ç—É–ª–µ–π
üìö <b>–¢–µ—Ö–Ω–∏–∫–∏</b> - —É–¥–∞—Ä—ã, —Å—Ç–æ–π–∫–∏, –±–ª–æ–∫–∏
üí° <b>–§–∞–∫—Ç –æ —Ç—É–ª—è—Ö</b> - —Å–ª—É—á–∞–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

<u><b>–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:</b></u>
‚Ä¢ "–ß–æ–Ω-–î–∂–∏"
‚Ä¢ "–ß–µ—Ä–Ω—ã–π –ø–æ—è—Å —Ç—É–ª—å"
‚Ä¢ "–•–≤–∞-–†–∞–Ω–≥"
‚Ä¢ "–°–∫–æ–ª—å–∫–æ –¥–≤–∏–∂–µ–Ω–∏–π –≤ –î–æ-–°–∞–Ω–µ?"

–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è!
        """

        await update.message.reply_text(
            welcome_text,
            reply_markup=self.get_main_menu(),
            parse_mode='HTML'
        )

    async def handle_message(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        user_id = update.effective_user.id
        query = update.message.text.strip()

        if not query:
            await update.message.reply_text(
                "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –∏–ª–∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞.",
                reply_markup=self.get_main_menu()
            )
            return

        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç"
        await context.bot.send_chat_action(
            chat_id=update.effective_chat.id,
            action='typing'
        )

        try:
            # –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —Ç—É–ª –ø–æ —Ç–æ—á–Ω–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é
            tul = self.knowledge.get_tul_by_name(query)

            if tul:
                await self._send_tul_info(update, tul)
                return

            # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ —Ç–æ—á–Ω–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é, –∏—â–µ–º –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
            results = self.knowledge.search_tuls(query)

            if results:
                if len(results) == 1:
                    await self._send_tul_info(update, results[0])
                else:
                    await self._send_search_results(update, results, query)
            else:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ—Ç –±—ã—Ç—å —ç—Ç–æ –ø–æ—è—Å
                for belt_key, belt_info in self.knowledge.belts.items():
                    if query.lower() in belt_info["color"].lower() or query.lower() in belt_info["name"].lower():
                        await self._send_belt_info(update, belt_key, belt_info)
                        return

                # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏
                await update.message.reply_text(
                    f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É: '{query}'\n\n"
                    "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:\n"
                    "‚Ä¢ –ù–∞–ø–∏—Å–∞—Ç—å —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è\n"
                    "‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏\n"
                    "‚Ä¢ –ó–∞–¥–∞—Ç—å –±–æ–ª–µ–µ –æ–±—â–∏–π –≤–æ–ø—Ä–æ—Å",
                    reply_markup=self.get_main_menu()
                )

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≤ handle_message: {e}", exc_info=True)
            await update.message.reply_text(
                "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",
                reply_markup=self.get_main_menu()
            )

    async def _send_tul_info(self, update, tul: Dict):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É–ª–µ"""
        response = f"""
üåÄ <b>{tul['name']}</b> <i>({tul['korean_name']})</i>

<b>–£—Ä–æ–≤–µ–Ω—å:</b> {tul['belt']}
<b>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–≤–∏–∂–µ–Ω–∏–π:</b> {tul['movements']}
<b>–ó–Ω–∞—á–µ–Ω–∏–µ:</b> {tul['meaning']}

<b>–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞:</b>
{tul['history']}

<b>–î–∏–∞–≥—Ä–∞–º–º–∞:</b> {tul['diagram']}
        """

        await update.message.reply_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _send_search_results(self, update, results: List[Dict], query: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞"""
        total_results = len(results)
        if total_results > 10:
            display_results = results[:10]
            extra_text = f"\n\n<i>–ü–æ–∫–∞–∑–∞–Ω–æ 10 –∏–∑ {total_results} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –£—Ç–æ—á–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.</i>"
        else:
            display_results = results
            extra_text = ""

        response = f"""
üîç <b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É: "{query}"</b>

–ù–∞–π–¥–µ–Ω–æ {total_results} —Ç—É–ª–µ–π:
        """

        for i, tul in enumerate(display_results, 1):
            response += f"\n{i}. <b>{tul['name']}</b> - {tul['belt']} ({tul['movements']} –¥–≤–∏–∂–µ–Ω–∏–π)"

        response += f"\n\n<i>–ù–∞–ø–∏—à–∏—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.</i>{extra_text}"

        await update.message.reply_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _send_belt_info(self, update, belt_key: str, belt_info: Dict):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—è—Å–µ"""
        # –ü–æ–ª—É—á–∞–µ–º —Ç—É–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—è—Å–∞
        tuls_info = []
        for tul_name in belt_info.get("tuls", []):
            tul = self.knowledge.get_tul_by_name(tul_name)
            if tul:
                tuls_info.append(f"‚Ä¢ {tul['name']} ({tul['movements']} –¥–≤–∏–∂–µ–Ω–∏–π) - {tul['meaning']}")

        response = f"""
üéΩ <b>{belt_info['name']} - {belt_info['color']}</b>

<b>–û–ø–∏—Å–∞–Ω–∏–µ:</b> {belt_info['description']}
<b>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è:</b> {belt_info.get('duration', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}

<b>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</b> {belt_info.get('requirements', '–ù–µ —É–∫–∞–∑–∞–Ω—ã')}

<b>–¢—É–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è:</b>
{chr(10).join(tuls_info) if tuls_info else '‚Ä¢ –ù–µ—Ç —Ç—É–ª–µ–π –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è'}
        """

        await update.message.reply_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def handle_callback(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ callback-–∑–∞–ø—Ä–æ—Å–æ–≤"""
        query = update.callback_query
        await query.answer()

        data = query.data

        try:
            if data == 'back_to_menu':
                await self._show_main_menu(query)

            elif data == 'all_tuls':
                await self._show_all_tuls(query)

            elif data == 'belts_system':
                await self._show_belts_system(query)

            elif data == 'search_tul':
                await query.edit_message_text(
                    "üîç <b>–ü–æ–∏—Å–∫ —Ç—É–ª—è</b>\n\n"
                    "–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –∏–ª–∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞.\n\n"
                    "–ü—Ä–∏–º–µ—Ä—ã:\n"
                    "‚Ä¢ –ß–æ–Ω-–î–∂–∏\n"
                    "‚Ä¢ 24 –¥–≤–∏–∂–µ–Ω–∏—è\n"
                    "‚Ä¢ –ö—Ä–∞—Å–Ω—ã–π –ø–æ—è—Å\n"
                    "‚Ä¢ –ö–æ—Ä–µ–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ\n",
                    reply_markup=self.get_back_menu(),
                    parse_mode='HTML'
                )

            elif data == 'tul_progression':
                await self._show_tul_progression(query)

            elif data == 'techniques':
                await self._show_techniques(query)

            elif data == 'random_tul_fact':
                await self._show_random_tul_fact(query)

            elif data == 'belt_timeline':
                await self._show_belt_timeline(query)

            elif data == 'help':
                await self._show_help(query)

            elif data.startswith('belt_'):
                # –ü–æ–∫–∞–∑–∞—Ç—å —Ç—É–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—è—Å–∞
                belt_name = data.replace('belt_', '')
                await self._show_tuls_for_belt(query, belt_name)

            elif data.startswith('belt_info_'):
                # –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—è—Å–µ
                belt_key = data.replace('belt_info_', '')
                await self._show_belt_info_callback(query, belt_key)

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback: {e}", exc_info=True)
            await query.edit_message_text(
                "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",
                reply_markup=self.get_main_menu()
            )

    async def _show_main_menu(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
        await query.edit_message_text(
            "ü•ã <b>–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:",
            reply_markup=self.get_main_menu(),
            parse_mode='HTML'
        )

    async def _show_all_tuls(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç—É–ª–∏"""
        await query.edit_message_text(
            "üåÄ <b>–í—Å–µ —Ç—É–ª–∏ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ø–æ—è—Å–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç—É–ª–µ–π:",
            reply_markup=self.get_tuls_menu(),
            parse_mode='HTML'
        )

    async def _show_tuls_for_belt(self, query, belt_name: str):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Ç—É–ª–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—è—Å–∞"""
        tuls = self.knowledge.get_tuls_by_belt(belt_name)

        if not tuls:
            await query.edit_message_text(
                f"–î–ª—è –ø–æ—è—Å–∞ '{belt_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Ç—É–ª–µ–π.",
                reply_markup=self.get_back_menu()
            )
            return

        response = f"üåÄ <b>–¢—É–ª–∏ –¥–ª—è —É—Ä–æ–≤–Ω—è: {belt_name}</b>\n\n"

        for i, tul in enumerate(tuls, 1):
            response += f"<b>{i}. {tul['name']}</b> ({tul['korean_name']})\n"
            response += f"   ‚Ä¢ –î–≤–∏–∂–µ–Ω–∏–π: {tul['movements']}\n"
            response += f"   ‚Ä¢ –ó–Ω–∞—á–µ–Ω–∏–µ: {tul['meaning']}\n"
            response += f"   ‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è: {tul['history'][:300]}...\n\n"

        response += "<i>–ù–∞–ø–∏—à–∏—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.</i>"

        await query.edit_message_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _show_belts_system(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ—è—Å–æ–≤"""
        await query.edit_message_text(
            "üéΩ <b>–°–∏—Å—Ç–µ–º–∞ –ø–æ—è—Å–æ–≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"
            "10 —É—á–µ–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π (–≥—ã–ø–æ–≤) –∏ 9 –º–∞—Å—Ç–µ—Ä—Å–∫–∏—Ö (–¥–∞–Ω–æ–≤).\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å:",
            reply_markup=self.get_belts_menu(),
            parse_mode='HTML'
        )

    async def _show_belt_info_callback(self, query, belt_key: str):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—è—Å–µ (callback)"""
        belt_info = self.knowledge.get_belt_info(belt_key)

        if not belt_info:
            await query.edit_message_text(
                "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—è—Å–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.",
                reply_markup=self.get_back_menu()
            )
            return

        await self._send_belt_info_callback(query, belt_key, belt_info)

    async def _send_belt_info_callback(self, query, belt_key: str, belt_info: Dict):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—è—Å–µ (callback)"""
        # –ü–æ–ª—É—á–∞–µ–º —Ç—É–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—è—Å–∞
        tuls_info = []
        for tul_name in belt_info.get("tuls", []):
            tul = self.knowledge.get_tul_by_name(tul_name)
            if tul:
                tuls_info.append(f"‚Ä¢ <b>{tul['name']}</b> - {tul['movements']} –¥–≤–∏–∂–µ–Ω–∏–π\n  <i>{tul['meaning']}</i>")

        response = f"""
üéΩ <b>{belt_info['name']} - {belt_info['color']}</b>

<b>–û–ø–∏—Å–∞–Ω–∏–µ:</b> {belt_info['description']}
<b>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è:</b> {belt_info.get('duration', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}

<b>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</b> {belt_info.get('requirements', '–ù–µ —É–∫–∞–∑–∞–Ω—ã')}

<b>–¢—É–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è:</b>
{chr(10).join(tuls_info) if tuls_info else '‚Ä¢ –ù–µ—Ç —Ç—É–ª–µ–π –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è'}
        """

        await query.edit_message_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _show_tul_progression(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é —Ç—É–ª–µ–π"""
        progression = self.knowledge.get_tul_progression()

        # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π
        chunks = []
        current_chunk = "üìä <b>–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –∏–∑—É—á–µ–Ω–∏—è —Ç—É–ª–µ–π –ø–æ –ø–æ—è—Å–∞–º</b>\n\n"

        for i, item in enumerate(progression):
            item_text = f"<b>{item['belt']} - {item['color']}</b> ({item['duration']})\n"

            if item['tuls']:
                for tul in item['tuls']:
                    item_text += f"  ‚Ä¢ {tul['name']} ({tul['movements']} –¥–≤.) - {tul['meaning'][:50]}...\n"
            else:
                item_text += "  ‚Ä¢ –ù–µ—Ç —Ç—É–ª–µ–π\n"

            item_text += "\n"

            # –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–µ–≤—ã—Å–∏—Ç –ª–∏–º–∏—Ç, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —á–∞–Ω–∫ –∏ –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π
            if len(current_chunk) + len(item_text) + 50 > 4000:  # 50 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è HTML —Ç–µ–≥–æ–≤ –∏ –æ—Ç—Å—Ç—É–ø–æ–≤
                current_chunk += "\n<i>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç...</i>"
                chunks.append(current_chunk)
                current_chunk = f"<b>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã...</b>\n\n{item_text}"
            else:
                current_chunk += item_text

        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞–Ω–∫
        if current_chunk:
            current_chunk += "<i>–í—Å–µ–≥–æ 24 —Ç—É–ª—è, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—â–∏—Ö 24 —á–∞—Å–∞ –≤ —Å—É—Ç–∫–∞—Ö.</i>"
            chunks.append(current_chunk)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π —á–∞–Ω–∫
        await query.edit_message_text(
            chunks[0],
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —á–∞–Ω–∫–∏ –∫–∞–∫ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        for chunk in chunks[1:]:
            await query.message.reply_text(
                chunk,
                reply_markup=self.get_back_menu(),
                parse_mode='HTML'
            )

    async def _show_techniques(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏"""
        techniques = self.knowledge.techniques

        response = "üìö <b>–¢–µ—Ö–Ω–∏–∫–∏ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"

        for category, items in techniques.items():
            response += f"<b>{category.upper()}:</b>\n"
            for name, description in items.items():
                response += f"‚Ä¢ <b>{name}</b>: {description}\n"
            response += "\n"

        response += "<i>–≠—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, –∏–∑—É—á–∞–µ–º—ã–µ –≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§.</i>"

        await query.edit_message_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _show_random_tul_fact(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ç—É–ª–µ"""
        fact = self.knowledge.get_random_tul_fact()

        response = f"üí° <b>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ç—É–ª—è—Ö:</b>\n\n{fact}\n\n"
        response += "<i>–•–æ—Ç–∏—Ç–µ –µ—â–µ —Ñ–∞–∫—Ç? –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –µ—â–µ —Ä–∞–∑!</i>"

        keyboard = [
            [InlineKeyboardButton("üí° –ï—â–µ —Ñ–∞–∫—Ç", callback_data='random_tul_fact')],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data='back_to_menu')]
        ]

        await query.edit_message_text(
            response,
            reply_markup=InlineKeyboardMarkup(keyboard),
            parse_mode='HTML'
        )

    async def _show_belt_timeline(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É –ø–æ—è—Å–æ–≤"""
        timeline = self.knowledge.get_belt_timeline()

        response = "‚è≥ <b>–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –ø–æ—è—Å–æ–≤</b>\n\n"
        response += "–ü—É—Ç—å –æ—Ç –±–µ–ª–æ–≥–æ –¥–æ —á–µ—Ä–Ω–æ–≥–æ –ø–æ—è—Å–∞:\n\n"

        for item in timeline:
            emoji = "ü•ã" if "–¥–∞–Ω" in item["belt"] else "üéΩ"
            response += f"{emoji} <b>{item['order']}. {item['belt']}</b> - {item['color']}\n"
            response += f"   <i>{item['description']}</i>\n"
            response += f"   –¢—É–ª–µ–π: {item['tuls_count']}\n\n"

        response += "<i>–ü—É—Ç—å –¥–ª–∏–Ω–æ—é –≤ –∂–∏–∑–Ω—å! –ß–µ—Ä–Ω—ã–π –ø–æ—è—Å - —ç—Ç–æ –Ω–µ –∫–æ–Ω–µ—Ü, –∞ –Ω–∞—á–∞–ª–æ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –ø—É—Ç–∏.</i>"

        await query.edit_message_text(
            response,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def _show_help(self, query):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É"""
        help_text = """
üÜò <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞</b>

<u>–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:</u>
‚Ä¢ <b>–ü–æ–∏—Å–∫ —Ç—É–ª–µ–π</b> - –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –∏–ª–∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ
‚Ä¢ <b>–ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ç—É–ª–µ–π</b> - –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–æ—è—Å–æ–≤
‚Ä¢ <b>–°–∏—Å—Ç–µ–º–∞ –ø–æ—è—Å–æ–≤</b> - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ
‚Ä¢ <b>–ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è</b> - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑—É—á–µ–Ω–∏—è —Ç—É–ª–µ–π

<u>–ö–∞–∫ –∏—Å–∫–∞—Ç—å:</u>
‚Ä¢ –ù–∞–ø–∏—à–∏—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ß–æ–Ω-–î–∂–∏")
‚Ä¢ –ù–∞–ø–∏—à–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ø–æ—è—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∫—Ä–∞—Å–Ω—ã–π –ø–æ—è—Å")
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "24 –¥–≤–∏–∂–µ–Ω–∏—è")
‚Ä¢ –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ—Ä–µ–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

<u>–ü—Ä–∏–º–µ—Ä—ã —Ç—É–ª–µ–π:</u>
‚Ä¢ –ß–æ–Ω-–î–∂–∏ (–ø–µ—Ä–≤—ã–π —Ç—É–ª—å, 19 –¥–≤–∏–∂–µ–Ω–∏–π)
‚Ä¢ –î–∞–Ω-–ì—É–Ω (–æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å –ö–æ—Ä–µ–∏, 21 –¥–≤–∏–∂–µ–Ω–∏–µ)
‚Ä¢ –î–æ-–°–∞–Ω (–ø–∞—Ç—Ä–∏–æ—Ç, 24 –¥–≤–∏–∂–µ–Ω–∏—è)
‚Ä¢ –•–≤–∞-–†–∞–Ω–≥ (–º–æ–ª–æ–¥–µ–∂–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ, 29 –¥–≤–∏–∂–µ–Ω–∏–π)

<u>–ö–æ–º–∞–Ω–¥—ã:</u>
/start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
/menu - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

<u>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã:</u>
‚Ä¢ –í—Å–µ–≥–æ 24 —Ç—É–ª—è (—Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç 24 —á–∞—Å–∞)
‚Ä¢ –ö–∞–∂–¥—ã–π —Ç—É–ª—å –∏–º–µ–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
‚Ä¢ –¢—É–ª–∏ –∏–∑—É—á–∞—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚Ä¢ –ß–µ—Ä–Ω—ã–π –ø–æ—è—Å –∏–º–µ–µ—Ç 9 –¥–∞–Ω–æ–≤

<i>–£–¥–∞—á–∏ –≤ –∏–∑—É—á–µ–Ω–∏–∏ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ! ü•ã</i>
        """

        await query.edit_message_text(
            help_text,
            reply_markup=self.get_back_menu(),
            parse_mode='HTML'
        )

    async def menu_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /menu"""
        await update.message.reply_text(
            "ü•ã <b>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:",
            reply_markup=self.get_main_menu(),
            parse_mode='HTML'
        )

    async def help_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /help"""
        help_text = """
<b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>

/start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
/menu - –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/tuls - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç—É–ª–∏
/belts - –ü–æ–∫–∞–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ—è—Å–æ–≤
/fact - –°–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É

<b>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</b>
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
‚Ä¢ –ü–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚Ä¢ –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞

<i>–ë–æ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ 24 —Ç—É–ª—è—Ö —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§!</i>
        """

        await update.message.reply_text(
            help_text,
            reply_markup=self.get_main_menu(),
            parse_mode='HTML'
        )

    async def tuls_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /tuls - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—É–ª–µ–π"""
        stats = self.knowledge.knowledge_base["statistics"]

        await update.message.reply_text(
            f"üåÄ <b>–í—Å–µ —Ç—É–ª–∏ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"
            f"–í—Å–µ–≥–æ —Ç—É–ª–µ–π: {stats['total_tuls']}\n"
            f"–í—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏–π: {stats['total_movements']}\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ø–æ—è—Å–∞:",
            reply_markup=self.get_tuls_menu(),
            parse_mode='HTML'
        )

    async def belts_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /belts - —Å–∏—Å—Ç–µ–º–∞ –ø–æ—è—Å–æ–≤"""
        await update.message.reply_text(
            "üéΩ <b>–°–∏—Å—Ç–µ–º–∞ –ø–æ—è—Å–æ–≤ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –ò–¢–§</b>\n\n"
            "10 —É—á–µ–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π (–≥—ã–ø–æ–≤) –∏ 9 –º–∞—Å—Ç–µ—Ä—Å–∫–∏—Ö (–¥–∞–Ω–æ–≤).\n\n"
            "–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å:",
            reply_markup=self.get_belts_menu(),
            parse_mode='HTML'
        )

    async def fact_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /fact - —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç"""
        fact = self.knowledge.get_random_tul_fact()
        await update.message.reply_text(
            f"üí° <b>–§–∞–∫—Ç –æ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ:</b>\n\n{fact}",
            reply_markup=self.get_main_menu()
        )

    async def error_handler(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫"""
        logger.error(f"–û—à–∏–±–∫–∞: {context.error}", exc_info=context.error)

        if update and update.effective_message:
            try:
                await update.effective_message.reply_text(
                    "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
                    reply_markup=self.get_main_menu()
                )
            except:
                pass


def main():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
    try:
        bot = TaekwondoTulBot()

        app = Application.builder().token(bot.TOKEN).build()

        # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥
        app.add_handler(CommandHandler("start", bot.start_command))
        app.add_handler(CommandHandler("menu", bot.menu_command))
        app.add_handler(CommandHandler("help", bot.help_command))
        app.add_handler(CommandHandler("tuls", bot.tuls_command))
        app.add_handler(CommandHandler("belts", bot.belts_command))
        app.add_handler(CommandHandler("fact", bot.fact_command))

        # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
        app.add_handler(CallbackQueryHandler(bot.handle_callback))
        app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, bot.handle_message))

        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
        app.add_error_handler(bot.error_handler)

        print("=" * 70)
        print("üåÄ –ë–û–¢-–≠–ù–¶–ò–ö–õ–û–ü–ï–î–ò–Ø –¢–£–õ–ï–ô –¢–•–≠–ö–í–û–ù–î–û –ò–¢–§ –ó–ê–ü–£–©–ï–ù!")
        print(f"üìö –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç—É–ª–µ–π: {len(bot.knowledge.tuls)}")
        print(f"üéΩ –£—Ä–æ–≤–Ω–µ–π –ø–æ—è—Å–æ–≤: {len(bot.knowledge.belts)}")
        print("üíæ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ")
        print("=" * 70)
        print("\nüì± –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞.")
        print("üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /start –≤ Telegram –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã")

        app.run_polling(drop_pending_updates=True)

    except ValueError as e:
        print(f"‚ùå –û–®–ò–ë–ö–ê: {e}")
        print("\n–î–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:")
        print("1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ")
        print("2. –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–≥–æ —Å—Ç—Ä–æ–∫—É:")
        print("   TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞")
        print("3. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —É @BotFather –≤ Telegram")
    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")


if __name__ == "__main__":
    main()


